{% extends 'base.html.twig' %}

{% block title %}Hello HomeController!
{% endblock %}

{% block body %}
	<div class="div-global">

		<h1 class="text-dark text-center pt-5">Lorem ipsum.</h1>

		<div class="barre-form shadow">
			<form action="{{ path('abonnements_post_search') }}" method="get" class="mb-4">
				<div class="input-group mb-3">
					<input type="text" class="form-control" name="q" placeholder="Rechercher une publication ...">
					<button class="btn btn-dark btn-rounded" type="submit">
						<i class="fas fa-magnifying-glass"></i>
					</button>
				</div>
			</form>

			<section class="d-flex justify-content-start">
				<a href="{{ path('app_home') }}" class="btn btn-outline-dark btn-rounded me-4">
					<i class="fas fa-xmark"></i>
				</a>
				<a href="#" class="btn btn-dark btn-rounded me-4">
					Catégorie
				</a>
				<a href="#" class="btn btn-dark btn-rounded me-4">
					Catégorie
				</a>
				<a href="#" class="btn btn-dark btn-rounded me-4">
					Catégorie
				</a>
			</section>
		</div>


		{% if app.user %}
			<section class="posts-TL">
				{% set months = ['janvier', 'février', 'mars', 'avril', 'mai', 'juin', 'juillet', 'août', 'septembre', 'octobre', 'novembre', 'décembre'] %}
				{% if abonnementsPosts %}
					<div class="row row-cols-1 row-cols-md-3 g-4">
						{% for abonnementsPost in abonnementsPosts %}
							<div class="col">
								<div class="card mb-4">
									{% if abonnementsPost.image %}
										<a href="{{ path('app_post_show', {'id': abonnementsPost.id, 'username': abonnementsPost.user.username}) }}" class=" text-dark">
											<img src="/assets/images/post/{{ abonnementsPost.image }}" class="card-img-top post-card-img shadow" alt="{{ abonnementsPost.title }}"/>
										</a>

										<a href="{{ path('app_post_show', {'id': abonnementsPost.id, 'username': abonnementsPost.user.username}) }}" class=" text-dark">
											<div class="card-body post-card-body-img">
												<div class="mb-2 div-btn-post-compteur">
													<button class="btn btn-light btn-post-compteur shadow">
														<i class="far fa-clock me-1"></i>
														{{ abonnementsPost.createdAt|date('d ') ~ months[abonnementsPost.createdAt|date('n')-1] ~ abonnementsPost.createdAt|date(' Y') }}
													</button>
												</div>

												{% if abonnementsPost.title %}
													<h5 class="card-title">{{ abonnementsPost.title }}</h5>
												{% else %}
													<div class="mt-3"></div>
												{% endif %}

												<p class="card-text">
													{{ abonnementsPost.content|striptags|length > 140 ? abonnementsPost.content|striptags|slice(0, 140) ~ ' ...' : abonnementsPost.content|striptags }}
												</p>
											</div>
										</a>
									{% else %}
										<a href="{{ path('app_post_show', {'id': abonnementsPost.id, 'username': abonnementsPost.user.username}) }}" class=" text-dark">
											<div class="card-body post-card-body">
												<div class="mb-2 div-btn-post-compteur">
													<button class="btn btn-light btn-post-compteur shadow">
														<i class="far fa-clock me-1"></i>
														{{ abonnementsPost.createdAt|date('d ') ~ months[abonnementsPost.createdAt|date('n')-1] ~ abonnementsPost.createdAt|date(' Y') }}
													</button>
												</div>

												{% if abonnementsPost.title %}
													<h5 class="card-title mt-1">
														{{ abonnementsPost.title }}
													</h5>
													<p class="card-text mt-3">
														{{ abonnementsPost.content|striptags|length > 700 ? abonnementsPost.content|striptags|slice(0, 700) ~ ' ...' : abonnementsPost.content|striptags }}
													</p>
												{% else %}
													<p class="card-text post-card-text">
														{{ abonnementsPost.content|striptags|length > 700 ? abonnementsPost.content|striptags|slice(0, 700) ~ ' ...' : abonnementsPost.content|striptags }}
													</p>
												{% endif %}
											</div>
										</a>
									{% endif %}
								</div>
							</div>
						{% endfor %}
					</div>
				{% else %}
					<p>Aucun résultat.</p>
				{% endif %}

			</section>
		{% else %}
			<a href="{{ path('app_login') }}">Connexion</a>
			<a href="{{ path('app_register') }}">Inscription</a>
		{% endif %}

	</div>
{% endblock %}
